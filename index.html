<!doctype html>
<html lang="es" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1, viewport-fit=cover" />
  <title>ARSLAN â€” Ventas 3 Tiendas</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>

  <!-- LOGIN -->
  <div id="loginView" class="view">
    <div class="card login">
      <div class="brand">
        <div class="logo">ğŸ¥</div>
        <div>
          <div class="brand-title">ARSLAN</div>
          <div class="brand-sub">Ventas diarias Â· 3 tiendas</div>
        </div>
      </div>

      <h1>Entrar</h1>
      <p class="muted">Introduce el PIN para acceder.</p>

      <div class="row gap">
        <input id="pinInput" class="input pin" inputmode="numeric" maxlength="10" placeholder="PIN" />
        <button id="btnLogin" class="btn primary">Entrar</button>
      </div>
      <div id="loginMsg" class="msg"></div>

      <div class="hr"></div>
      <div class="row space">
        <div class="muted small">Modo</div>
        <button id="btnThemeLogin" class="btn ghost">ğŸŒ™/â˜€ï¸</button>
      </div>
    </div>
  </div>

  <!-- APP -->
  <div id="appView" class="app hidden">
    <!-- Topbar -->
    <header class="topbar">
      <div class="top-left">
        <div class="badge">ğŸ¥ ARSLAN</div>
        <div class="top-title">
          <div class="t">Ventas</div>
          <div class="s muted small" id="topSub">â€”</div>
        </div>
      </div>

      <div class="top-actions">
        <button id="btnTheme" class="btn ghost">ğŸŒ™/â˜€ï¸</button>
        <button id="btnBackup" class="btn ghost">Exportar</button>
        <label class="btn ghost file">
          Importar
          <input id="importFile" type="file" accept="application/json" hidden />
        </label>
        <button id="btnLogout" class="btn danger ghost">Salir</button>
      </div>
    </header>

    <!-- Content -->
    <main class="content">

      <!-- HOME -->
      <section id="viewHome" class="page">
        <div class="page-head">
          <div>
            <h2>Hoy</h2>
            <div class="muted small">Resumen rÃ¡pido (toca una tienda para entrar).</div>
          </div>
          <div class="row gap">
            <input id="homeDate" type="date" class="input compact" />
            <button id="btnWAHomeDay" class="btn whatsapp">WhatsApp</button>
          </div>
        </div>

        <div class="grid cards3" id="homeCards"></div>

        <div class="card soft">
          <div class="row space wrap">
            <div>
              <div class="muted small">GLOBAL (hoy)</div>
              <div class="big" id="homeGlobalTotal">â€”</div>
              <div class="muted small" id="homeGlobalBreak">â€”</div>
            </div>
            <div class="tags" id="homeGlobalFlags"></div>
          </div>
        </div>

        <div class="card">
          <div class="row space wrap">
            <div>
              <h3>Tendencia (7 dÃ­as) â€” Global</h3>
              <div class="muted small">Solo total (claro y rÃ¡pido).</div>
            </div>
            <div class="row gap">
              <button class="chip active" data-home7="total">Total</button>
              <button class="chip" data-home7="cash">Efectivo</button>
              <button class="chip" data-home7="card">Tarjeta</button>
            </div>
          </div>
          <canvas id="chartHome7" height="140"></canvas>
        </div>
      </section>

      <!-- STORE -->
      <section id="viewStore" class="page hidden">
        <div class="page-head">
          <div>
            <h2 id="storeTitle">Tienda</h2>
            <div class="muted small">Entrada diaria + rendimiento</div>
          </div>
          <div class="row gap">
            <input id="storeDate" type="date" class="input compact" />
            <button id="btnWAStoreDay" class="btn whatsapp">WhatsApp</button>
          </div>
        </div>

        <!-- Entry -->
        <div class="card">
          <div class="row space wrap">
            <div>
              <h3>Entrada del dÃ­a</h3>
              <div class="muted small" id="storeEntryHint">â€”</div>
            </div>
            <div class="tags" id="storeFlags"></div>
          </div>

          <div class="grid two">
            <div class="field">
              <label>Efectivo (â‚¬)</label>
              <input id="inCash" class="input" inputmode="decimal" placeholder="0,00" />
            </div>
            <div class="field">
              <label>Tarjeta (â‚¬)</label>
              <input id="inCard" class="input" inputmode="decimal" placeholder="0,00" />
            </div>
            <div class="field">
              <label>Importe ticket (â‚¬)</label>
              <input id="inTicket" class="input" inputmode="decimal" placeholder="0,00" />
            </div>
            <div class="field">
              <label>Diferencia ticket</label>
              <div class="input readonly" id="boxDiffTicket">â€”</div>
            </div>
          </div>

          <div class="hr"></div>

          <div class="row space wrap">
            <h3>Caja (simple)</h3>
            <div class="muted small">Esperado = Efectivo âˆ’ Gastos âˆ’ Retiradas + Extra</div>
          </div>

          <div class="grid two">
            <div class="field">
              <label>Gastos (â‚¬)</label>
              <input id="inExpenses" class="input" inputmode="decimal" placeholder="0,00" />
            </div>
            <div class="field">
              <label>Retiradas (â‚¬)</label>
              <input id="inWithdraw" class="input" inputmode="decimal" placeholder="0,00" />
            </div>
            <div class="field">
              <label>Ingresos extra (â‚¬)</label>
              <input id="inExtra" class="input" inputmode="decimal" placeholder="0,00" />
            </div>
            <div class="field">
              <label>Efectivo contado (caja real) (â‚¬)</label>
              <input id="inCounted" class="input" inputmode="decimal" placeholder="0,00" />
            </div>
          </div>

          <div class="grid two">
            <div class="field">
              <label>Efectivo esperado</label>
              <div class="input readonly" id="boxExpected">â€”</div>
            </div>
            <div class="field">
              <label>Diferencia caja</label>
              <div class="input readonly" id="boxDiffCash">â€”</div>
            </div>
          </div>

          <div class="field" style="margin-top:10px">
            <label>Observaciones</label>
            <textarea id="inNotes" class="input textarea" rows="3" placeholder="Ej: pago proveedor, falta 10â‚¬, cambio, etc."></textarea>
          </div>

          <div class="row gap wrap" style="margin-top:10px">
            <button id="btnSaveEntry" class="btn primary">Guardar</button>
            <button id="btnClearEntry" class="btn">Limpiar</button>
            <button id="btnDeleteEntry" class="btn danger ghost">Borrar</button>
          </div>

          <div id="storeMsg" class="msg"></div>
        </div>

        <!-- Performance -->
        <div class="card">
          <div class="row space wrap">
            <div>
              <h3>Rendimiento</h3>
              <div class="muted small">Cambiar periodo y ver totales + tendencia.</div>
            </div>
            <div class="row gap wrap">
              <button class="chip active" data-store-period="7d">7 dÃ­as</button>
              <button class="chip" data-store-period="30d">30 dÃ­as</button>
              <button class="chip" data-store-period="month">Mes</button>
            </div>
          </div>

          <div class="kpis">
            <div class="kpi"><div class="k">Total</div><div class="v" id="kStoreTotal">â€”</div></div>
            <div class="kpi"><div class="k">Efectivo</div><div class="v" id="kStoreCash">â€”</div></div>
            <div class="kpi"><div class="k">Tarjeta</div><div class="v" id="kStoreCard">â€”</div></div>
            <div class="kpi"><div class="k">Ticket</div><div class="v" id="kStoreTicket">â€”</div></div>
            <div class="kpi"><div class="k">Dif ticket</div><div class="v" id="kStoreDiff">â€”</div></div>
            <div class="kpi"><div class="k">Media/dÃ­a</div><div class="v" id="kStoreAvg">â€”</div></div>
          </div>

          <div class="charts2">
            <div class="chartBox">
              <div class="row space">
                <div class="muted small">Total por dÃ­a</div>
                <div class="muted small" id="storeRangeLabel">â€”</div>
              </div>
              <canvas id="chartStoreTotal" height="150"></canvas>
            </div>
            <div class="chartBox">
              <div class="muted small">Efectivo vs Tarjeta</div>
              <canvas id="chartStoreMix" height="150"></canvas>
            </div>
          </div>
        </div>

        <!-- Recent -->
        <div class="card">
          <div class="row space wrap">
            <div>
              <h3>Ãšltimos registros</h3>
              <div class="muted small">Toca una fila para cargar ese dÃ­a.</div>
            </div>
            <button id="btnRefreshStoreList" class="btn ghost">Actualizar</button>
          </div>

          <div class="tableWrap">
            <table class="table" id="storeTable">
              <thead>
                <tr>
                  <th>Fecha</th><th>Total</th><th>Ticket</th><th>DifT</th><th>DifCaja</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- GLOBAL -->
      <section id="viewGlobal" class="page hidden">
        <div class="page-head">
          <div>
            <h2>Global</h2>
            <div class="muted small">Comparativa y rendimiento general.</div>
          </div>
          <div class="row gap wrap">
            <select id="globalPeriod" class="input compact">
              <option value="7d">7 dÃ­as</option>
              <option value="30d">30 dÃ­as</option>
              <option value="month">Mes actual</option>
            </select>
            <button id="btnWAGlobal" class="btn whatsapp">WhatsApp</button>
          </div>
        </div>

        <div class="kpis">
          <div class="kpi"><div class="k">Total</div><div class="v" id="kGTotal">â€”</div></div>
          <div class="kpi"><div class="k">Efectivo</div><div class="v" id="kGCash">â€”</div></div>
          <div class="kpi"><div class="k">Tarjeta</div><div class="v" id="kGCard">â€”</div></div>
          <div class="kpi"><div class="k">Ticket</div><div class="v" id="kGTicket">â€”</div></div>
          <div class="kpi"><div class="k">Dif ticket</div><div class="v" id="kGDiff">â€”</div></div>
          <div class="kpi"><div class="k">Media/dÃ­a</div><div class="v" id="kGAvg">â€”</div></div>
        </div>

        <div class="card">
          <div class="row space wrap">
            <div>
              <h3>Comparativa de tiendas</h3>
              <div class="muted small">Total por tienda (mismo periodo).</div>
            </div>
            <div class="muted small" id="globalRangeLabel">â€”</div>
          </div>
          <canvas id="chartGlobalBars" height="160"></canvas>
        </div>

        <div class="card">
          <div class="row space wrap">
            <div>
              <h3>Tendencia global</h3>
              <div class="muted small">Total por dÃ­a (3 tiendas).</div>
            </div>
          </div>
          <canvas id="chartGlobalLine" height="160"></canvas>
        </div>

        <div class="card">
          <div class="row space wrap">
            <div>
              <h3>Ranking</h3>
              <div class="muted small">Orden por total del periodo.</div>
            </div>
          </div>
          <div id="globalRanking" class="rank"></div>
        </div>
      </section>

    </main>

    <!-- Bottom nav (mobile-first) -->
    <nav class="bottomNav">
      <button class="navBtn active" data-nav="home">ğŸ <span>Inicio</span></button>
      <button class="navBtn" data-nav="sp">ğŸª<span>Pablo</span></button>
      <button class="navBtn" data-nav="sl">ğŸª<span>Lesmes</span></button>
      <button class="navBtn" data-nav="sa">ğŸª<span>Santiago</span></button>
      <button class="navBtn" data-nav="global">ğŸŒ<span>Global</span></button>
    </nav>

    <div class="safe-bottom"></div>
  </div>

  <script src="app.js"></script>
</body>
</html>
